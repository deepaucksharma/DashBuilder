# NRDOT v2 with DashBuilder - Environment Configuration
# Copy this file to .env and fill in your values

# ============================================
# REQUIRED: New Relic Configuration
# ============================================
# Your New Relic License Key (40 characters)
# Get it from: https://one.newrelic.com/admin-portal/api-keys/home
NEW_RELIC_LICENSE_KEY=your_license_key_here

# Your New Relic API Key
# Required permissions: NRQL query, GraphQL, Metrics ingest
NEW_RELIC_API_KEY=your_api_key_here

# Your New Relic Account ID
# Find it in your New Relic URL or account settings
NEW_RELIC_ACCOUNT_ID=your_account_id_here

# ============================================
# OPTIONAL: New Relic Configuration
# ============================================
# Region (US or EU)
NEW_RELIC_REGION=US

# OTLP endpoint override (defaults are set based on region)
# US: https://otlp.nr-data.net
# EU: https://otlp.eu01.nr-data.net
# OTEL_EXPORTER_OTLP_ENDPOINT=https://otlp.nr-data.net

# ============================================
# OTEL Configuration
# ============================================
# Service identification
OTEL_SERVICE_NAME=nrdot
OTEL_SERVICE_VERSION=2.0
OTEL_RESOURCE_ATTRIBUTES=service.name=nrdot,service.version=2.0

# ============================================
# NRDOT Configuration
# ============================================
# Optimization mode: conservative, balanced, aggressive, emergency
OPTIMIZATION_MODE=balanced

# Control loop interval in seconds (how often to check and adjust)
CONTROL_LOOP_INTERVAL=300

# Experiment duration in seconds
EXPERIMENT_DURATION=3600

# Feature flags
ENABLE_DEBUG=false
ENABLE_EXPERIMENTS=false
ENABLE_CONTROL_LOOP=true

# ============================================
# Process Filtering Configuration
# ============================================
# Process include pattern (regex)
PROCESS_INCLUDE_PATTERN=.*

# Process exclude pattern (regex)
PROCESS_EXCLUDE_PATTERN=(kernel|systemd-|ssh-agent|kworker)

# Minimum thresholds for process inclusion
MIN_CPU_THRESHOLD=0.1           # CPU percentage
MIN_MEMORY_THRESHOLD=10485760   # Memory in bytes (10MB)

# ============================================
# Cost Configuration
# ============================================
# Cost per million data points (USD)
COST_PER_MILLION_DATAPOINTS=0.25

# Target cost reduction percentage
TARGET_COST_REDUCTION=0.70

# Critical process coverage threshold
CRITICAL_PROCESS_THRESHOLD=0.95

# ============================================
# Application Configuration
# ============================================
# Node environment: development, production
NODE_ENV=production

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Web dashboard port
WEB_PORT=8090

# ============================================
# Resource Configuration
# ============================================
# Memory settings for OTEL collector
GOGC=80
GOMEMLIMIT=460MiB

# Container resource limits (Docker Compose)
CONTAINER_CPU_LIMIT=1.0
CONTAINER_MEMORY_LIMIT=512M

# ============================================
# Monitoring Configuration (optional)
# ============================================
# Grafana admin credentials (use docker secrets in production)
GF_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme

# Prometheus retention
PROMETHEUS_RETENTION_TIME=24h
PROMETHEUS_RETENTION_SIZE=1GB

# ============================================
# Security Configuration
# ============================================
# Enable TLS for internal communication
ENABLE_TLS=false

# TLS certificate paths (when ENABLE_TLS=true)
TLS_CERT_PATH=/etc/ssl/certs/nrdot.crt
TLS_KEY_PATH=/etc/ssl/private/nrdot.key

# ============================================
# Advanced Configuration
# ============================================
# OpenTelemetry Collector version
OTEL_VERSION=0.96.0

# Batch processor settings
BATCH_TIMEOUT=10s
BATCH_SIZE=1000

# Memory limiter settings
MEMORY_LIMIT=512MiB
MEMORY_SPIKE_LIMIT=128MiB

# ============================================
# Development Configuration
# ============================================
# Enable verbose logging
VERBOSE=false

# Enable dry run mode (no actual changes)
DRY_RUN=false

# Enable local file exports for debugging
ENABLE_FILE_EXPORTER=false

# ============================================
# Docker Configuration
# ============================================
# Docker registry for custom images
DOCKER_REGISTRY=

# Image tag
IMAGE_TAG=latest

# Docker network subnet (if customizing)
DOCKER_NETWORK_SUBNET=172.28.0.0/16